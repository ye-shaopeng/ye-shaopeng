# main

```javascript
/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => EditorWidthSlider
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// src/settings/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  // sliderPercentage: "20",
  sliderPercentage: "24",
  sliderPercentage1: "10",
  sliderPercentage2: "24",
  sliderPercentage3: "66",
  // === tab limit ===
  globalTabLimit: "4",
  tabLimit1: "4",
  tabLimit2: "5",
  tabLimit3: "6",
  tabLimit4: "88"
  // === tab limit ===
  // sliderPercentageDefault: "20",
  // sliderWidth: "150"
};
var EditorWidthSliderSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  // this.settings.sliderWidth
  display() {
    const { containerEl } = this;
    containerEl.empty();
    // new import_obsidian.Setting(containerEl).setName("Slider Width").setDesc("How wide do you want your slider to be?").addText((text) => text.setPlaceholder("Slider width in px").setValue(this.plugin.settings.sliderWidth).onChange(async (value) => {
    // this.plugin.settings.sliderWidth = value;
    // this.plugin.updateSliderStyle();
    // await this.plugin.saveSettings();
    // }));
    // new import_obsidian.Setting(containerEl).setName("Slider Default Percentage").setDesc("What do you want the default percentage of the slider to be?").addText((text) => text.setPlaceholder("Slider width in px").setValue(this.plugin.settings.sliderPercentageDefault).onChange(async (value) => {
    // this.plugin.settings.sliderPercentageDefault = value;
    // this.plugin.updateSliderStyle();
    // await this.plugin.saveSettings();
    // }));
    // new import_obsidian.Setting(containerEl).setName("Note:").setDesc(`The field should be named "editor-width" in the YAML frontmatter of the note in order to customize the editor width of that repective note. It won't work globally for all notes unless you specify it in each note's frontmatter.`);
    // === 设置面板 ===
    new import_obsidian.Setting(containerEl).setName("Slider Percentage 1").addText((text) => text.setValue(this.plugin.settings.sliderPercentage1).onChange(async (value) => {
      this.plugin.settings.sliderPercentage1 = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Slider Percentage 2").addText((text) => text.setValue(this.plugin.settings.sliderPercentage2).onChange(async (value) => {
      this.plugin.settings.sliderPercentage2 = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Slider Percentage 3").addText((text) => text.setValue(this.plugin.settings.sliderPercentage3).onChange(async (value) => {
      this.plugin.settings.sliderPercentage3 = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Tab Limit 1").addText((text) => text.setValue(this.plugin.settings.tabLimit1).onChange(async (value) => {
      this.plugin.settings.tabLimit1 = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Tab Limit 2").addText((text) => text.setValue(this.plugin.settings.tabLimit2).onChange(async (value) => {
      this.plugin.settings.tabLimit2 = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Tab Limit 3").addText((text) => text.setValue(this.plugin.settings.tabLimit3).onChange(async (value) => {
      this.plugin.settings.tabLimit3 = value;
      await this.plugin.saveSettings();
    }));
    // === 设置面板 ===
  }
};

// src/modal/warning.ts
var import_obsidian2 = require("obsidian");
var WarningModal = class extends import_obsidian2.Modal {
  constructor(app2) {
    super(app2);
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.setText("Editor width must be a number from 0 to 100!");
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/main.ts
var EditorWidthSlider = class extends import_obsidian3.Plugin {
  constructor() {
    super(...arguments);
    this.pattern = /^(?:[0-9]{1,2}|100)$/;
  }
  // most important function, this gets executed everytime the plugin is first
  // loaded, e.g. when obsidian starts, or when the user just installed the
  // plugin
  async onload() {
    await this.loadSettings();
    this.addStyle();
    this.app.workspace.on("file-open", () => {
      this.updateEditorStyleYAML();
    });
    this.createSlider();
    this.addSettingTab(new EditorWidthSliderSettingTab(this.app, this));
    // === tab limit ===
    this.registerEvent(this.app.workspace.on("layout-change", () => {
      this.enforceTabLimit();
    }));
    // === tab limit ===
  }

  // === tab limit ===
  enforceTabLimit() {
    const openTabs = this.app.workspace.getLeavesOfType("markdown");
    if (openTabs.length > parseInt(this.settings.globalTabLimit)) {
      openTabs[openTabs.length - 1].detach();
      // new import_obsidian.Notice("Tab limit reached. Unable to open more tabs.");
    }
  }
  // === tab limit ===

  // async onLoadFile(file: TFile) {
  // }
  onunload() {
    this.cleanUpResources();
  }
  // ---------------------------- SLIDER -------------------------------------
  // createSlider() {
  // const slider = document.createElement("input");
  // slider.classList.add("editor-width-slider");
  // slider.id = "editor-width-slider";
  // slider.type = "range";
  // slider.min = "0";
  // slider.max = "100";
  // slider.value = this.settings.sliderPercentage;
  // slider.style.width = this.settings.sliderWidth + "px";
  // slider.addEventListener("input", (event) => {
  // const value = parseInt(slider.value);
  // this.settings.sliderPercentage = value.toString();
  // this.saveSettings();
  // this.updateEditorStyle();
  // sliderValueText.textContent = value.toString();
  // console.log("Slider value:", value);
  // });
  // const sliderValueText = document.createElement("span");
  // sliderValueText.textContent = slider.value;
  // sliderValueText.classList.add("editor-width-slider-value");
  // sliderValueText.id = "editor-width-slider-value";
  // sliderValueText.style.color = "white";
  // sliderValueText.style.padding = "8px 5px";
  // sliderValueText.style.display = "inline";
  // sliderValueText.style.borderRadius = "18%";
  // sliderValueText.style.border = "0";
  // sliderValueText.style.margin = "0px 10px";
  // sliderValueText.style.background = "var(--interactive-accent)";
  // sliderValueText.style.fontSize = "13px";
  // sliderValueText.style.lineHeight = "50%";
  // sliderValueText.style.width = "auto";
  // sliderValueText.style.height = "auto";
  // sliderValueText.style.boxSizing = "content-box";
  // sliderValueText.style.transition = "background 0.3s";
  // sliderValueText.style.cursor = "pointer";
  // sliderValueText.addEventListener("mouseenter", function() {
  // sliderValueText.style.background = "red";
  // });
  // sliderValueText.addEventListener("mouseleave", function() {
  // sliderValueText.style.background = "var(--interactive-accent)";
  // });
  // sliderValueText.addEventListener("click", () => {
  // console.log("test");
  // this.resetEditorWidth();
  // });
  // const statusBarItemEl = this.addStatusBarItem();
  // statusBarItemEl.appendChild(slider);
  // statusBarItemEl.appendChild(sliderValueText);
  // }
  // === 底部状态栏 按钮 ===
  disableStyle(span) {
    const svgElement = span.querySelector("svg");
    svgElement.style.stroke = "var(--editor-width-slider-value-disable)";
    // svgElement.style.strokeWidth = "2px";
  }
  enableStyle(span) {
    const svgElement = span.querySelector("svg");
    svgElement.style.stroke = "var(--editor-width-slider-value-enable)";
    // svgElement.style.strokeWidth = "2.5px";
  }
  createSlider() {
    let sliderValueTextOld = null;

    const sliderValueText1 = document.createElement("span");
    sliderValueText1.innerHTML = `<svg style="vertical-align: middle; margin-left: 4px; margin-right: 4px;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open-icon lucide-book-open"><path d="M12 7v14"/><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"/></svg>`;
    if (this.settings.sliderPercentage == this.settings.sliderPercentage1) {
      sliderValueTextOld = sliderValueText1;
      this.enableStyle(sliderValueTextOld);
    }
    sliderValueText1.addEventListener("click", () => {
      this.settings.sliderPercentage = this.settings.sliderPercentage1;
      this.saveSettings();
      this.updateEditorStyle();
      if (sliderValueTextOld != null && sliderValueTextOld != sliderValueText1) {
        this.disableStyle(sliderValueTextOld);
      }
      sliderValueTextOld = sliderValueText1;
      this.enableStyle(sliderValueTextOld);
    });

    const sliderValueText2 = document.createElement("span");
    sliderValueText2.innerHTML = `<svg style="vertical-align: middle; margin-left: 4px; margin-right: 4px;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-files-icon lucide-files"><path d="M15 2h-4a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8"/><path d="M16.706 2.706A2.4 2.4 0 0 0 15 2v5a1 1 0 0 0 1 1h5a2.4 2.4 0 0 0-.706-1.706z"/><path d="M5 7a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h8a2 2 0 0 0 1.732-1"/></svg>`;
    if (this.settings.sliderPercentage == this.settings.sliderPercentage2) {
      sliderValueTextOld = sliderValueText2;
      this.enableStyle(sliderValueTextOld);
    }
    sliderValueText2.addEventListener("click", () => {
      this.settings.sliderPercentage = this.settings.sliderPercentage2;
      this.saveSettings();
      this.updateEditorStyle();
      if (sliderValueTextOld != null && sliderValueTextOld != sliderValueText2) {
        this.disableStyle(sliderValueTextOld);
      }
      sliderValueTextOld = sliderValueText2;
      this.enableStyle(sliderValueTextOld);
    });

    const sliderValueText3 = document.createElement("span");
    sliderValueText3.innerHTML = `<svg style="vertical-align: middle; margin-left: 4px; margin-right: 4px;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-icon lucide-file"><path d="M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"/><path d="M14 2v5a1 1 0 0 0 1 1h5"/></svg>`;
    if (this.settings.sliderPercentage == this.settings.sliderPercentage3) {
      sliderValueTextOld = sliderValueText3;
      this.enableStyle(sliderValueTextOld);
    }
    sliderValueText3.addEventListener("click", () => {
      this.settings.sliderPercentage = this.settings.sliderPercentage3;
      this.saveSettings();
      this.updateEditorStyle();
      if (sliderValueTextOld != null && sliderValueTextOld != sliderValueText3) {
        this.disableStyle(sliderValueTextOld);
      }
      sliderValueTextOld = sliderValueText3;
      this.enableStyle(sliderValueTextOld);
    });

    // === tab limit ===
    let tabLimitValueTextOld = null;

    const tabLimitValueText1 = document.createElement("span");
    tabLimitValueText1.innerHTML = `<svg style="vertical-align: middle; margin-left: 4px; margin-right: 4px;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-icon lucide-file"><path d="M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"/><path d="M14 2v5a1 1 0 0 0 1 1h5"/></svg>`;
    if (this.settings.globalTabLimit == this.settings.tabLimit1) {
      tabLimitValueTextOld = tabLimitValueText1;
      this.enableStyle(tabLimitValueTextOld);
    }
    tabLimitValueText1.addEventListener("click", () => {
      this.settings.globalTabLimit = this.settings.tabLimit1;
      this.saveSettings();
      if (tabLimitValueTextOld != null && tabLimitValueTextOld != tabLimitValueText1) {
        this.disableStyle(tabLimitValueTextOld);
      }
      tabLimitValueTextOld = tabLimitValueText1;
      this.enableStyle(tabLimitValueTextOld);
    });

    const tabLimitValueText2 = document.createElement("span");
    tabLimitValueText2.innerHTML = `<svg style="vertical-align: middle; margin-left: 4px; margin-right: 4px;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-files-icon lucide-files"><path d="M15 2h-4a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8"/><path d="M16.706 2.706A2.4 2.4 0 0 0 15 2v5a1 1 0 0 0 1 1h5a2.4 2.4 0 0 0-.706-1.706z"/><path d="M5 7a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h8a2 2 0 0 0 1.732-1"/></svg>`;
    if (this.settings.globalTabLimit == this.settings.tabLimit2) {
      tabLimitValueTextOld = tabLimitValueText2;
      this.enableStyle(tabLimitValueTextOld);
    }
    tabLimitValueText2.addEventListener("click", () => {
      this.settings.globalTabLimit = this.settings.tabLimit2;
      this.saveSettings();
      if (tabLimitValueTextOld != null && tabLimitValueTextOld != tabLimitValueText2) {
        this.disableStyle(tabLimitValueTextOld);
      }
      tabLimitValueTextOld = tabLimitValueText2;
      this.enableStyle(tabLimitValueTextOld);
    });

    const tabLimitValueText3 = document.createElement("span");
    tabLimitValueText3.innerHTML = `<svg style="vertical-align: middle; margin-left: 4px; margin-right: 4px;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-stack-icon lucide-file-stack"><path d="M11 21a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1"/><path d="M16 16a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1"/><path d="M21 6a2 2 0 0 0-.586-1.414l-2-2A2 2 0 0 0 17 2h-3a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1z"/></svg>`;
    if (this.settings.globalTabLimit == this.settings.tabLimit3) {
      tabLimitValueTextOld = tabLimitValueText3;
      this.enableStyle(tabLimitValueTextOld);
    }
    tabLimitValueText3.addEventListener("click", () => {
      this.settings.globalTabLimit = this.settings.tabLimit3;
      this.saveSettings();
      if (tabLimitValueTextOld != null && tabLimitValueTextOld != tabLimitValueText3) {
        this.disableStyle(tabLimitValueTextOld);
      }
      tabLimitValueTextOld = tabLimitValueText3;
      this.enableStyle(tabLimitValueTextOld);
    });

    const tabLimitValueText4 = document.createElement("span");
    tabLimitValueText4.innerHTML = `<svg style="vertical-align: middle; margin-left: 4px; margin-right: 16px;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open-text-icon lucide-book-open-text"><path d="M12 7v14"/><path d="M16 12h2"/><path d="M16 8h2"/><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"/><path d="M6 12h2"/><path d="M6 8h2"/></svg>`;
    if (this.settings.globalTabLimit == this.settings.tabLimit4) {
      tabLimitValueTextOld = tabLimitValueText4;
      this.enableStyle(tabLimitValueTextOld);
    }
    tabLimitValueText4.addEventListener("click", () => {
      this.settings.globalTabLimit = this.settings.tabLimit4;
      this.saveSettings();
      if (tabLimitValueTextOld != null && tabLimitValueTextOld != tabLimitValueText4) {
        this.disableStyle(tabLimitValueTextOld);
      }
      tabLimitValueTextOld = tabLimitValueText4;
      this.enableStyle(tabLimitValueTextOld);
    });
    // === tab limit ===

    const statusBarItemEl = this.addStatusBarItem();
    // === tab limit ===
    statusBarItemEl.appendChild(tabLimitValueText1);
    statusBarItemEl.appendChild(tabLimitValueText2);
    statusBarItemEl.appendChild(tabLimitValueText3);
    statusBarItemEl.appendChild(tabLimitValueText4);
    // === tab limit ===
    statusBarItemEl.appendChild(sliderValueText1);
    statusBarItemEl.appendChild(sliderValueText2);
    statusBarItemEl.appendChild(sliderValueText3);
  }
  // === 底部状态栏 按钮 ===
  // ---------------------------- SLIDER -------------------------------------
  cleanUpResources() {
    this.resetEditorWidth();
  }
  resetEditorWidth() {
    // this.settings.sliderPercentage = this.settings.sliderPercentageDefault;
    this.settings.sliderPercentage = this.settings.sliderPercentage2;
    // === tab limit ===
    this.settings.globalTabLimit = this.settings.tabLimit1;
    // === tab limit ===
    // const styleElements = document.getElementsByClassName("editor-width-slider");
    // const slider = document.getElementById("editor-width-slider");
    // const sliderValue = document.getElementById("editor-width-slider-value");
    // if (slider) {
    // if (sliderValue) {
    // console.log("2");
    // slider.value = this.settings.sliderPercentageDefault;
    // sliderValue.textContent = this.settings.sliderPercentageDefault.toString();
    // }
    // }
    this.saveSettings();
    this.updateEditorStyleYAML();
  }
  // add element that contains all of the styling elements we need
  addStyle() {
    const css = document.createElement("style");
    css.id = "additional-editor-css";
    document.getElementsByTagName("head")[0].appendChild(css);
    document.body.classList.add("additional-editor-css");
  }
  // update the styles (at the start, or as the result of a settings change)
  updateEditorStyle() {
    const styleElement = document.getElementById("additional-editor-css");
    if (!styleElement)
      throw "additional-editor-css element not found!";
    else {
      styleElement.innerText = `
body {
  --file-line-width: calc(710px + 10 * ${this.settings.sliderPercentage}px) !important;
}
`;
    }
  }
  // update the styles (at the start, or as the result of a settings change)
  updateEditorStyleYAMLHelper(editorWidth) {
    const styleElement = document.getElementById("additional-editor-css");
    if (!styleElement)
      throw "additional-editor-css element not found!";
    else {
      styleElement.innerText = `
body {
  /* --file-line-width: calc(100px + ${editorWidth}vw) !important; */
  --file-line-width: calc(710px + 10 * ${editorWidth}px) !important;
}
`;
    }
  }
  validateString(inputString) {
    return this.pattern.test(inputString);
  }
  updateEditorStyleYAML() {
    console.log("1.1");
    const file = this.app.workspace.getActiveFile();
    console.log("1.2");
    if (file.name) {
      const metadata = app.metadataCache.getFileCache(file);
      if (metadata) {
        if (metadata.frontmatter) {
          try {
            if (metadata.frontmatter["editor-width"]) {
              if (this.validateString(metadata.frontmatter["editor-width"])) {
                this.updateEditorStyleYAMLHelper(metadata.frontmatter["editor-width"]);
              } else {
                new WarningModal(this.app).open();
                throw new Error("Editor width must be a number from 0 to 100.");
              }
            } else {
              this.updateEditorStyle();
            }
          } catch (e) {
            console.error("Error:", e.message);
          }
        } else {
          this.updateEditorStyle();
        }
      }
    }
  }
  // update the styles (at the start, or as the result of a settings change)
  updateSliderStyle() {
    const styleElements = document.getElementsByClassName("editor-width-slider");
    if (styleElements.length === 0) {
      throw new Error("editor-width-slider-value element not found!");
    } else {
      const styleElement = styleElements[0];
      styleElement.style.width = this.settings.sliderWidth + "px";
    }
  }
  // Method to load settings
  async loadSettings() {
    this.settings = Object.assign(
      {},
      DEFAULT_SETTINGS,
      await this.loadData()
    );
  }
  // Method to store settings
  async saveSettings() {
    await this.saveData(this.settings);
  }
};

/* nosourcemap */
```
